<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>אליפות הסולפג' – הימורים</title>
  <style>
    body { font-family: system-ui, Arial; margin: 16px; line-height: 1.35; }
    .card { border: 1px solid #ddd; border-radius: 16px; padding: 14px; margin: 12px 0; }
    h1 { font-size: 20px; margin: 0 0 10px; }
    h2 { font-size: 16px; margin: 0 0 10px; }
    label { display: block; margin: 10px 0 6px; }
    select, input { width: 100%; padding: 10px; border-radius: 12px; border: 1px solid #ccc; background: white; }
    button { padding: 12px 14px; border-radius: 14px; border: 1px solid #111; background: #111; color: #fff; width: 100%; font-size: 16px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .muted { color: #666; font-size: 13px; }
    .ok { color: #0a7; }
    .err { color: #c33; }
    #errBanner { display:none; border:1px solid #c33; color:#c33; border-radius:14px; padding:10px; margin-bottom:12px; }
  </style>
</head>
<body>
  <div id="errBanner"></div>

  <h1>אליפות הסולפג' – טופס הימורים</h1>
  <div class="muted">ממלאים בתים → האתר בונה רבעים/חצאים/גמר → שולחים.</div>

  <div class="card">
    <h2>פרטים</h2>
    <label>שם התלמיד/ה</label>
    <input id="studentName" placeholder="למשל: אמה" />
  </div>

  <div class="card">
    <h2>שלב הבתים</h2>
    <div id="groups"></div>
    <div class="muted">בכל בית לבחור מקום 1 ומקום 2 (לא אותו שם פעמיים).</div>
  </div>

  <div class="card">
    <h2>רבע גמר (נבנה אוטומטית)</h2>
    <div id="quarters"></div>
  </div>

  <div class="card">
    <h2>חצי גמר</h2>
    <div id="semis"></div>
  </div>

  <div class="card">
    <h2>גמר + אלוף</h2>
    <div id="finals"></div>
  </div>

  <div class="card">
    <button id="submitBtn">שלח הימורים</button>
    <div id="status" class="muted" style="margin-top:10px;"></div>
  </div>

<script>
  // מציג שגיאות JS ישירות על המסך (כדי שלא תרגיש ש"הדף נדפק" בלי להבין למה)
  window.onerror = function(msg, src, line, col) {
    const b = document.getElementById("errBanner");
    b.style.display = "block";
    b.textContent = `שגיאת JavaScript: ${msg} (שורה ${line})`;
  };

  const SCRIPT_URL = "PASTE_YOUR_SCRIPT_URL_HERE"; // <- תדביק כאן את ה-/exec שלך

  // בתים (לפי החלוקה שעשינו)
  const HOUSES = {
    "בית א׳": ["אורי גולן","סתיו","יהונתן","אביתר"],
    "בית ב׳": ["אמה","דריה","אורי לנקרי","איתמר"],
    "בית ג׳": ["עופר","אביב","איתי","יהלי"],
    "בית ד׳": ["אמילי","אריאל","לינוי"]
  };

  // רבעים לפי המבנה שבנית
  const QUARTER_RULES = [
    { id:"QF1", title:"רבע גמר 1", a:{house:"בית א׳", pos:1}, b:{house:"בית ג׳", pos:2} },
    { id:"QF2", title:"רבע גמר 2", a:{house:"בית א׳", pos:2}, b:{house:"בית ג׳", pos:1} },
    { id:"QF3", title:"רבע גמר 3", a:{house:"בית ב׳", pos:1}, b:{house:"בית ד׳", pos:2} },
    { id:"QF4", title:"רבע גמר 4", a:{house:"בית ד׳", pos:1}, b:{house:"בית ב׳", pos:2} },
  ];

  const state = {
    groups: {},   // { "בית א׳": {1:"...",2:"..."} }
    quarters: {}, // { QF1:"winner", ... }
    semis: {},    // { SF1:"winner", SF2:"winner" }
    finals: {},   // { F:"winner", CHAMP:"winner" }
  };

  function el(tag, attrs={}, children=[]) {
    const n = document.createElement(tag);
    Object.entries(attrs).forEach(([k,v]) => (k==="class") ? n.className=v : n.setAttribute(k,v));
    (Array.isArray(children)?children:[children]).forEach(c => n.appendChild(typeof c==="string"?document.createTextNode(c):c));
    return n;
  }

  function makeSelect(options, placeholder="בחר") {
    const s = el("select");
    s.appendChild(el("option",{value:""}, placeholder));
    options.forEach(o => s.appendChild(el("option",{value:o}, o)));
    return s;
  }

  function validateHouse(house, s1, s2) {
    if (s1.value && s2.value && s1.value === s2.value) {
      alert(`ב${house} אי אפשר לבחור את אותו שם גם מקום 1 וגם מקום 2`);
      s2.value = "";
      state.groups[house][2] = "";
    }
  }

  function renderGroups() {
    const root = document.getElementById("groups");
    root.innerHTML = "";
    Object.keys(HOUSES).forEach(house => {
      const card = el("div",{class:"card"});
      card.appendChild(e
